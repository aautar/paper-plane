{"version":3,"file":"paper-plane.min.js","sources":["../src/PaperPlane.js","../src/PaperPlane.window.js"],"sourcesContent":["const PaperPlane = {};\r\n\r\nPaperPlane.ContentType = {\r\n    APPLICATION_JSON: \"application/json\"\r\n};\r\n\r\nPaperPlane.convertBlobToString = function(_blob, _onConvert) {\r\n    const reader = new FileReader();\r\n    reader.readAsText(_blob); \r\n    reader.onloadend = function() {\r\n        _onConvert(reader.result);\r\n    };\r\n};\r\n\r\n/**\r\n * \r\n * @param {Blob} _respBlob \r\n * @returns {String|Object|Blob}\r\n */\r\nPaperPlane.parseXHRResponseData = function(_respBlob, _onParseComplete) {\r\n    if(typeof _respBlob === 'undefined' || _respBlob === null || _respBlob.size === 0) {\r\n        _onParseComplete(_respBlob);\r\n        return;\r\n    }\r\n\r\n    if(_respBlob.type === PaperPlane.ContentType.APPLICATION_JSON) {\r\n        var parsedResponseBody = {};\r\n        \r\n        PaperPlane.convertBlobToString(_respBlob, function(_blobTextual) {\r\n            parsedResponseBody = JSON.parse(_blobTextual);\r\n            _onParseComplete(parsedResponseBody);\r\n        });\r\n\r\n    } else if(_respBlob.type.split('/')[0] === 'text') {\r\n        PaperPlane.convertBlobToString(_respBlob, function(_blobTextual) {\r\n            _onParseComplete(_blobTextual);\r\n        });\r\n    } else {\r\n        _onParseComplete(_respBlob);\r\n    }\r\n};\r\n\r\n/**\r\n * @param {FormData} _data\r\n * @param {Map=} _httpHeaders\r\n * @returns {Object}\r\n */\r\nPaperPlane.makeFormDataRequestData = function(_data, _httpHeaders) {\r\n    return {\r\n        body: _data,\r\n        headers: (_httpHeaders || new Map())\r\n    };\r\n};\r\n\r\n/**\r\n * @param {Object} _data\r\n * @param {Map=} _httpHeaders\r\n * @returns {Object}\r\n */\r\nPaperPlane.makeJsonRequestData = function(_data, _httpHeaders) {\r\n    _httpHeaders = _httpHeaders || (new Map());\r\n    _httpHeaders.set(\"Content-Type\", PaperPlane.ContentType.APPLICATION_JSON);\r\n\r\n    return {\r\n        body: JSON.stringify(_data),\r\n        headers: _httpHeaders\r\n    };\r\n};\r\n\r\n/**\r\n * @param {Blob} _blob\r\n * @param {Map=} _httpHeaders\r\n * @returns {Object}\r\n */\r\nPaperPlane.makeBlobRequestData = function(_blob, _httpHeaders) {\r\n    _httpHeaders = _httpHeaders || (new Map());\r\n    _httpHeaders.set(\"Content-Type\", _blob.type);\r\n\r\n    return {\r\n        body: _blob,\r\n        headers: _httpHeaders\r\n    };\r\n};\r\n\r\n\r\n/**\r\n * @param {Map} _params\r\n * @returns {String}\r\n */\r\n PaperPlane.makeUrlQueryString = function(_params) {\r\n    const queryParts = [];\r\n    for (let [key, value] of _params) {\r\n        queryParts.push(`${key}=${encodeURIComponent(value)}`);\r\n    }\r\n\r\n    return \"?\" + queryParts.join(\"&\");\r\n};\r\n\r\n/**\r\n * @callback PaperPlane~responseCallback\r\n * @param {String|Object} responseData\r\n * @param {XMLHttpRequest} xhr\r\n */\r\n\r\n\r\n/**\r\n * \r\n * @param {String} _method\r\n * @param {String} _url\r\n * @param {Object} _requestData\r\n * @param {PaperPlane~responseCallback} [_onSuccess]\r\n * @param {PaperPlane~responseCallback} [_onError]\r\n * @param {PaperPlane~responseCallback} [_onComplete]\r\n * @returns {XMLHttpRequest}\r\n */\r\nPaperPlane.xhr = function(\r\n    _method, \r\n    _url,\r\n    _requestData,\r\n    _onSuccess,\r\n    _onError,\r\n    _onComplete,\r\n    _clientSettings\r\n) {\r\n    const httpHeaders = _requestData.headers;\r\n    _onSuccess = _onSuccess || (() => {});\r\n    _onError = _onError || (() => {});        \r\n    _onComplete = _onComplete || (() => {});    \r\n\r\n    const internalErrorHander = function(_xhr, _errorMessageHint) {\r\n        if(_errorMessageHint) {\r\n            _onError(_errorMessageHint, xhr);\r\n        } else {\r\n            PaperPlane.parseXHRResponseData(xhr.response, function(_parsedResponse) {\r\n                _onError(_parsedResponse, xhr);\r\n            });\r\n        }\r\n    };\r\n\r\n    const xhr = new XMLHttpRequest();\r\n    xhr.open(_method, _url);\r\n\r\n    for (let [key,value] of httpHeaders) {\r\n        xhr.setRequestHeader(key, value);\r\n    }\r\n\r\n    xhr.responseType = 'blob';\r\n\r\n    if(_clientSettings && _clientSettings.timeout) {\r\n        xhr.timeout = _clientSettings.timeout;\r\n    } else {\r\n        xhr.timeout = 30000;\r\n    }\r\n\r\n    xhr.onload = function() {\r\n        if(xhr.status >= 400) {\r\n            internalErrorHander(xhr);\r\n        } else {\r\n            PaperPlane.parseXHRResponseData(xhr.response, function(_parsedResponse) {\r\n                _onSuccess(_parsedResponse, xhr);\r\n            });\r\n        }\r\n    };\r\n\r\n    xhr.ontimeout = function() {\r\n        internalErrorHander(xhr, \"client timeout\");\r\n    };\r\n\r\n    xhr.onerror = function() {\r\n        internalErrorHander(xhr);\r\n    };\r\n\r\n    xhr.onloadend = function() {\r\n        PaperPlane.parseXHRResponseData(xhr.response, function(_parsedResponse) {\r\n            _onComplete(_parsedResponse, xhr);\r\n        });\r\n    };\r\n\r\n    xhr.send(_requestData.body);\r\n\r\n    return xhr;\r\n};\r\n\r\n/**\r\n * \r\n * @param {String} _url\r\n * @param {Object} _requestData\r\n * @param {PaperPlane~responseCallback} _onSuccess\r\n * @param {PaperPlane~responseCallback} _onError\r\n * @param {PaperPlane~responseCallback} _onComplete\r\n * @returns {XMLHttpRequest}\r\n */\r\nPaperPlane.post = function(\r\n    _url, \r\n    _requestData,\r\n    _onSuccess, \r\n    _onError, \r\n    _onComplete\r\n) {\r\n    return PaperPlane.xhr(\r\n        \"POST\",\r\n        _url,\r\n        _requestData,\r\n        _onSuccess,\r\n        _onError,\r\n        _onComplete\r\n    );\r\n};\r\n\r\n\r\n/**\r\n * \r\n * @param {String} _url\r\n * @param {Object} _requestData\r\n * @param {PaperPlane~responseCallback} _onSuccess\r\n * @param {PaperPlane~responseCallback} _onError\r\n * @param {PaperPlane~responseCallback} _onComplete\r\n * @returns {XMLHttpRequest}\r\n */\r\nPaperPlane.put = function(\r\n    _url, \r\n    _requestData,\r\n    _onSuccess, \r\n    _onError, \r\n    _onComplete\r\n) {\r\n    return PaperPlane.xhr(\r\n        \"PUT\",\r\n        _url,\r\n        _requestData,\r\n        _onSuccess,\r\n        _onError,\r\n        _onComplete\r\n    );\r\n\r\n};\r\n\r\n\r\n/**\r\n * \r\n * @param {String} _url\r\n * @param {Object} _requestData\r\n * @param {PaperPlane~responseCallback} _onSuccess\r\n * @param {PaperPlane~responseCallback} _onError\r\n * @param {PaperPlane~responseCallback} _onComplete\r\n * @returns {XMLHttpRequest}\r\n */\r\nPaperPlane.delete = function(\r\n    _url, \r\n    _requestData,\r\n    _onSuccess, \r\n    _onError, \r\n    _onComplete\r\n) {\r\n    return PaperPlane.xhr(\r\n        \"DELETE\",\r\n        _url,\r\n        _requestData,\r\n        _onSuccess,\r\n        _onError,\r\n        _onComplete\r\n    );\r\n};\r\n\r\n/**\r\n * @param {String} _url \r\n * @param {Object} [_httpHeaders={}]\r\n * @param {PaperPlane~responseCallback} _onSuccess\r\n * @param {PaperPlane~responseCallback} _onError\r\n * @param {PaperPlane~responseCallback} _onComplete\r\n * @returns {XMLHttpRequest}\r\n */\r\nPaperPlane.get = function(\r\n    _url, \r\n    _httpHeaders,\r\n    _onSuccess, \r\n    _onError, \r\n    _onComplete\r\n) {\r\n    return PaperPlane.xhr(\r\n        \"GET\",\r\n        _url,\r\n        {\r\n            body: null,\r\n            headers: _httpHeaders\r\n        },\r\n        _onSuccess,\r\n        _onError,\r\n        _onComplete\r\n    ); \r\n};\r\n\r\n/**\r\n * @param {String} _url \r\n * @param {Object} [_httpHeaders={}]\r\n * @param {PaperPlane~responseCallback} _onSuccess\r\n * @param {PaperPlane~responseCallback} _onError\r\n * @param {PaperPlane~responseCallback} _onComplete\r\n * @returns {XMLHttpRequest}\r\n */\r\nPaperPlane.head = function(\r\n    _url, \r\n    _httpHeaders,\r\n    _onSuccess, \r\n    _onError, \r\n    _onComplete\r\n) {\r\n    return PaperPlane.xhr(\r\n        \"HEAD\",\r\n        _url,\r\n        {\r\n            body: null,\r\n            headers: _httpHeaders\r\n        },\r\n        _onSuccess,\r\n        _onError,\r\n        _onComplete\r\n    ); \r\n};\r\n\r\n\r\n/**\r\n * \r\n * @param {String} _url\r\n * @param {Object} _requestData\r\n * @returns {Boolean}\r\n */\r\nPaperPlane.postBeacon = function(_url, _requestData) {\r\n    return navigator.sendBeacon(_url, _requestData.body);\r\n};\r\n\r\nexport { PaperPlane };\r\n","import {PaperPlane} from './PaperPlane'\r\n\r\nwindow.PaperPlane = PaperPlane;\r\n"],"names":["PaperPlane","ContentType","APPLICATION_JSON","convertBlobToString","_blob","_onConvert","reader","FileReader","readAsText","onloadend","result","parseXHRResponseData","_respBlob","_onParseComplete","size","type","parsedResponseBody","_blobTextual","JSON","parse","split","makeFormDataRequestData","_data","_httpHeaders","body","headers","Map","makeJsonRequestData","set","stringify","makeBlobRequestData","makeUrlQueryString","_params","queryParts","key","value","push","encodeURIComponent","join","xhr","_method","_url","_requestData","_onSuccess","_onError","_onComplete","_clientSettings","httpHeaders","internalErrorHander","_xhr","_errorMessageHint","response","_parsedResponse","XMLHttpRequest","open","setRequestHeader","responseType","timeout","onload","status","ontimeout","onerror","send","post","put","delete","get","head","postBeacon","navigator","sendBeacon","window"],"mappings":"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"}